<!--
SPDX-License-Identifier: MIT
Copyright (c) 2025 Advanced Micro Devices, Inc. All rights reserved.
-->

# All-Store benchmark

All-Store benchmark using Iris.

## Usage

```terminal
mpirun -np 8 python examples/p2p/all_store/all_store_bench.py
```
On an MI300X, this example will run on 8 GPUs. It prints:

```terminal
Total Bandwidth (GiB/s) vs Buffer Size
Buffer Size       GPU 00      GPU 01      GPU 02      GPU 03      GPU 04      GPU 05      GPU 06      GPU 07
1.0MB             109.66       97.11       93.52       88.46       93.68       98.78       95.68       99.79
2.0MB             102.86      113.60      104.36       90.74       98.87       95.39       93.30       98.82
4.0MB              98.28       93.44       90.87       85.02       80.44       86.12       92.24       90.67
8.0MB             152.54      130.74      126.88      113.32      114.29      125.56      137.56      147.31
16.0MB            191.88      180.22      157.43      133.37      132.85      155.80      176.26      188.23
32.0MB            230.57      219.13      199.12      172.11      172.99      197.58      210.66      226.87
64.0MB            259.65      250.38      237.04      214.94      213.36      233.32      242.07      255.58
128.0MB           272.54      265.47      258.93      244.05      247.33      256.42      263.54      270.44
256.0MB           285.22      280.35      276.40      267.87      268.63      273.16      278.66      283.20
512.0MB           289.72      286.54      284.19      280.50      279.10      281.50      285.57      287.17
1024.0MB          293.10      290.37      288.86      287.54      285.47      286.41      289.52      290.73
2048.0MB          294.23      291.70      291.04      290.82      288.10      288.58      291.32      292.21
4096.0MB          295.15      292.63      292.29      292.59      289.73      289.78      292.71      293.11
```